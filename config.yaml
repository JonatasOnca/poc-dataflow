gcp:
  project_id: abemcomum-saev-prod
  region: us-central1
  # region: US
  network: default
  subnetwork: default
  bucket_name: gs://abemcomum-saev-prod

artefact_registry:
  repository: dataflow-templates
  location: us-central1
  image_name: mysql-to-bq-dataflow-multiple-tables

database:
  driver_class_name: com.mysql.cj.jdbc.Driver
  driver_jars: _drivers/mysql-connector-j-8.0.33.jar

dataflow:
  job_name: '{{ artefact_registry.image_name }}-ingestion'
  template_file_name: '{{ artefact_registry.image_name }}-template.json'
  parameters:
    sdk_container_image: ''
    temp_location: '{{ gcp.bucket_name }}/{{ artefact_registry.image_name }}/temp'
    staging_location: '{{ gcp.bucket_name }}/{{ artefact_registry.image_name }}/staging'
    queries_location: '{{ gcp.bucket_name }}/{{ artefact_registry.image_name }}/queries'
    schemas_location: '{{ gcp.bucket_name }}/{{ artefact_registry.image_name }}/schemas'
    landing_zone_gcs_path_table: '{{ gcp.bucket_name }}/{{ artefact_registry.image_name }}/landing_zone'
    fetch_size: 25000
    runner: DataflowRunner    
    # Parâmetros adicionais para otimização
    machine_type: n1-standard-1
    # machine_type: "n1-standard-2"
    # num_workers: 1
    # max_num_workers: 5

# Credenciais do banco de dados de origem
source_db:
  secret_id: dataflow-mysql-credentials
  secret_version: latest

# Dataset de destino no BigQuery
landing_zone_dataset: landing_zone
bronze_dataset: bronze
silver_dataset: silver
gold_dataset: gold
region: US

load_type:
  backfill:
    - HEAVIEST_1
    - HEAVIEST_2
    - HEAVIEST_3
    - MEDIUM
    - LIGHT
    - REPLACE_ALWAYS_UNIQUE
    - REPLACE_ALWAYS
  delta:
    - HEAVIEST_1
    - HEAVIEST_2
    - HEAVIEST_3
    - MEDIUM
    - LIGHT
  merge:
    - HEAVIEST_1
    - HEAVIEST_2
    - HEAVIEST_3
    - MEDIUM
    - LIGHT

# Copyright 2025 TecOnca Data Solutions.


# Lista de tabelas para ingestão
tables:
- name: aluno
  query_file: aluno.sql
  schema_file: aluno.json
  delta_config:
    column: ALU_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: ALU_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - ALU_ID
  partitioning_config:
    type: DAY
    column: ALU_DT_ATUALIZACAO
  clustering_config:
    columns:
      - ALU_ID
      - ALU_COD
      - ALU_OLD_ID
  
- name: aluno_alu_deficiencias_pcd
  query_file: aluno_alu_deficiencias_pcd.sql
  schema_file: aluno_alu_deficiencias_pcd.json
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - alunoALUID
      - pcdPCDID
  partitioning_config:
    type: DAY
  clustering_config:
    columns:
      - alunoALUID
      - pcdPCDID
  
- name: aluno_teste
  query_file: aluno_teste.sql
  schema_file: aluno_teste.json
  delta_config:
    column: ALT_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: ALT_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - ALT_ID
  partitioning_config:
    type: DAY
    column: ALT_DT_ATUALIZACAO
  clustering_config:
    columns:
      - ALT_ID
      - ALT_ALU_ID
      - ALT_TES_ID
  
- name: aluno_teste_resposta
  query_file: aluno_teste_resposta.sql
  schema_file: aluno_teste_resposta.json
  delta_config:
    column: ATR_DT_CRIACAO
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: ATR_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - ATR_ID
  partitioning_config:
    type: DAY
    column: ATR_DT_CRIACAO
  clustering_config:
    columns:
      - ATR_ID
  
- name: aluno_teste_resposta_historico
  query_file: aluno_teste_resposta_historico.sql
  schema_file: aluno_teste_resposta_historico.json
  delta_config:
    column: ATH_DT_CRIACAO
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: ATH_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - ATH_ID
  partitioning_config:
    type: DAY
    column: ATH_DT_CRIACAO
  clustering_config:
    columns:
      - ATH_ID
  
- name: ano_letivo
  query_file: ano_letivo.sql
  schema_file: ano_letivo.json
  delta_config:
    column: ANO_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: ANO_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - ANO_ID
  partitioning_config:
    type: DAY
    column: ANO_DT_ATUALIZACAO
  clustering_config:
    columns:
      - ANO_ID
      - ANO_OLD_ID
  
- name: area
  query_file: area.sql
  schema_file: area.json
  delta_config:
    column: ARE_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: ARE_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - ARE_ID
  partitioning_config:
    type: DAY
    column: ARE_DT_ATUALIZACAO
  clustering_config:
    columns:
      - ARE_ID
  
- name: avaliacao
  query_file: avaliacao.sql
  schema_file: avaliacao.json
  delta_config:
    column: AVA_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: AVA_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - AVA_ID
  partitioning_config:
    type: DAY
    column: AVA_DT_ATUALIZACAO
  clustering_config:
    columns:
      - AVA_ID
      - AVA_OLD_ID
  
- name: avaliacao_municipio
  query_file: avaliacao_municipio.sql
  schema_file: avaliacao_municipio.json
  delta_config:
    column: AVM_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: AVM_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - AVM_ID
  partitioning_config:
    type: DAY
    column: AVM_DT_ATUALIZACAO
  clustering_config:
    columns:
      - AVM_ID
      - AVM_MUN_ID
      - AVM_OLD_ID
      - AVM_TIPO
  
- name: avaliacao_online
  query_file: avaliacao_online.sql
  schema_file: avaliacao_online.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: avaliacao_online_page
  query_file: avaliacao_online_page.sql
  schema_file: avaliacao_online_page.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: avaliacao_online_question
  query_file: avaliacao_online_question.sql
  schema_file: avaliacao_online_question.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
      - questionTemplateId
  
- name: avaliacao_online_question_alternative
  query_file: avaliacao_online_question_alternative.sql
  schema_file: avaliacao_online_question_alternative.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: avaliacao_teste
  query_file: avaliacao_teste.sql
  schema_file: avaliacao_teste.json
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - AVA_ID
      - TES_ID
  partitioning_config:
    type: DAY
  clustering_config:
    columns:
      - AVA_ID
      - TES_ID
  
- name: disciplina
  query_file: disciplina.sql
  schema_file: disciplina.json
  delta_config:
    column: DIS_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: DIS_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - DIS_ID
  partitioning_config:
    type: DAY
    column: DIS_DT_ATUALIZACAO
  clustering_config:
    columns:
      - DIS_ID
      - DIS_OLD_ID
  
- name: escola
  query_file: escola.sql
  schema_file: escola.json
  delta_config:
    column: ESC_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: ESC_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - ESC_ID
  partitioning_config:
    type: DAY
    column: ESC_DT_ATUALIZACAO
  clustering_config:
    columns:
      - ESC_ID
      - ESC_OLD_ID
  
- name: estados
  query_file: estados.sql
  schema_file: estados.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
      - abbreviation
      - name
  
- name: forget_password
  query_file: forget_password.sql
  schema_file: forget_password.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
      - userUSUID
  
- name: formacao
  query_file: formacao.sql
  schema_file: formacao.json
  delta_config:
    column: FOR_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: FOR_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - FOR_ID
  partitioning_config:
    type: DAY
    column: FOR_DT_ATUALIZACAO
  clustering_config:
    columns:
      - FOR_ID
  
- name: genero
  query_file: genero.sql
  schema_file: genero.json
  delta_config:
    column: GEN_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: GEN_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - GEN_ID
  partitioning_config:
    type: DAY
    column: GEN_DT_ATUALIZACAO
  clustering_config:
    columns:
      - GEN_ID
  
- name: infrequencia
  query_file: infrequencia.sql
  schema_file: infrequencia.json
  delta_config:
    column: IFR_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: IFR_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - IFR_ID
  partitioning_config:
    type: DAY
    column: IFR_DT_ATUALIZACAO
  clustering_config:
    columns:
      - IFR_ID
      - IFR_OLD_ID
  
- name: job
  query_file: job.sql
  schema_file: job.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: matriz_referencia
  query_file: matriz_referencia.sql
  schema_file: matriz_referencia.json
  delta_config:
    column: MAR_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: MAR_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - MAR_ID
  partitioning_config:
    type: DAY
    column: MAR_DT_ATUALIZACAO
  clustering_config:
    columns:
      - MAR_ID
      - MAR_OLD_ID
  
- name: matriz_referencia_serie
  query_file: matriz_referencia_serie.sql
  schema_file: matriz_referencia_serie.json
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - MAR_ID
      - SER_ID
  partitioning_config:
    type: DAY
  clustering_config:
    columns:
      - MAR_ID
      - SER_ID
  
- name: matriz_referencia_topico
  query_file: matriz_referencia_topico.sql
  schema_file: matriz_referencia_topico.json
  delta_config:
    column: MTO_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: MTO_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - MTO_ID
  partitioning_config:
    type: DAY
    column: MTO_DT_ATUALIZACAO
  clustering_config:
    columns:
      - MTO_ID
      - MTO_OLD_ID
  
- name: matriz_referencia_topico_items
  query_file: matriz_referencia_topico_items.sql
  schema_file: matriz_referencia_topico_items.json
  delta_config:
    column: MTI_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: MTI_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - MTI_ID
  partitioning_config:
    type: DAY
    column: MTI_DT_ATUALIZACAO
  clustering_config:
    columns:
      - MTI_ID
      - MTI_OLD_ID
  
- name: messages
  query_file: messages.sql
  schema_file: messages.json
  delta_config:
    column: MEN_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: MEN_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - MEN_ID
  partitioning_config:
    type: DAY
    column: MEN_DT_ATUALIZACAO
  clustering_config:
    columns:
      - MEN_ID
  
- name: messages_municipios_municipio
  query_file: messages_municipios_municipio.sql
  schema_file: messages_municipios_municipio.json
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - messagesMENID
      - municipioMUNID
  partitioning_config:
    type: DAY
  clustering_config:
    columns:
      - messagesMENID
      - municipioMUNID
  
- name: messages_schools_escola
  query_file: messages_schools_escola.sql
  schema_file: messages_schools_escola.json
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - escolaESCID
      - messagesMENID
  partitioning_config:
    type: DAY
  clustering_config:
    columns:
      - escolaESCID
      - messagesMENID
  
- name: migrations
  query_file: migrations.sql
  schema_file: migrations.json
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
  clustering_config:
    columns:
      - id
  
- name: municipio
  query_file: municipio.sql
  schema_file: municipio.json
  delta_config:
    column: MUN_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: MUN_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - MUN_ID
  partitioning_config:
    type: DAY
    column: MUN_DT_ATUALIZACAO
  clustering_config:
    columns:
      - MUN_ID
      - MUN_OLD_ID
  
- name: pcd
  query_file: pcd.sql
  schema_file: pcd.json
  delta_config:
    column: PCD_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: PCD_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - PCD_ID
  partitioning_config:
    type: DAY
    column: PCD_DT_ATUALIZACAO
  clustering_config:
    columns:
      - PCD_ID
      - PCD_OLD_ID
  
- name: perfil_base
  query_file: perfil_base.sql
  schema_file: perfil_base.json
  delta_config:
    column: PER_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: PER_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - PER_ID
  partitioning_config:
    type: DAY
    column: PER_DT_ATUALIZACAO
  clustering_config:
    columns:
      - PER_ID
  
- name: professor
  query_file: professor.sql
  schema_file: professor.json
  delta_config:
    column: PRO_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: PRO_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - PRO_ID
  partitioning_config:
    type: DAY
    column: PRO_DT_ATUALIZACAO
  clustering_config:
    columns:
      - PRO_ID
      - PRO_OLD_ID
  
- name: raca
  query_file: raca.sql
  schema_file: raca.json
  delta_config:
    column: PEL_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: PEL_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - PEL_ID
  partitioning_config:
    type: DAY
    column: PEL_DT_ATUALIZACAO
  clustering_config:
    columns:
      - PEL_ID
      - PEL_OLD_ID
  
- name: regionais
  query_file: regionais.sql
  schema_file: regionais.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: report_descriptor
  query_file: report_descriptor.sql
  schema_file: report_descriptor.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: report_edition
  query_file: report_edition.sql
  schema_file: report_edition.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: report_not_evaluated
  query_file: report_not_evaluated.sql
  schema_file: report_not_evaluated.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: report_question
  query_file: report_question.sql
  schema_file: report_question.json
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
  clustering_config:
    columns:
      - id
  
- name: report_race
  query_file: report_race.sql
  schema_file: report_race.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: report_subject
  query_file: report_subject.sql
  schema_file: report_subject.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%dT%H:%M:%S.%f'
    type: datetime
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: series
  query_file: series.sql
  schema_file: series.json
  delta_config:
    column: SER_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: SER_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - SER_ID
  partitioning_config:
    type: DAY
    column: SER_DT_ATUALIZACAO
  clustering_config:
    columns:
      - SER_ID
      - SER_OLD_ID
  
- name: sub_perfil
  query_file: sub_perfil.sql
  schema_file: sub_perfil.json
  delta_config:
    column: SPE_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: SPE_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - SPE_ID
  partitioning_config:
    type: DAY
    column: SPE_DT_ATUALIZACAO
  clustering_config:
    columns:
      - SPE_ID
  
- name: sub_perfil_area
  query_file: sub_perfil_area.sql
  schema_file: sub_perfil_area.json
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - ARE_ID
      - SPE_ID
  partitioning_config:
    type: DAY
  clustering_config:
    columns:
      - ARE_ID
      - SPE_ID
  
- name: teste
  query_file: teste.sql
  schema_file: teste.json
  delta_config:
    column: TES_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: TES_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - TES_ID
  partitioning_config:
    type: DAY
    column: TES_DT_ATUALIZACAO
  clustering_config:
    columns:
      - TES_ID
      - TES_OLD_ID
      - assessmentOnlineId
  
- name: teste_gabarito
  query_file: teste_gabarito.sql
  schema_file: teste_gabarito.json
  delta_config:
    column: TEG_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: TEG_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - TEG_ID
  partitioning_config:
    type: DAY
    column: TEG_DT_ATUALIZACAO
  clustering_config:
    columns:
      - TEG_ID
      - TEG_OLD_ID
  
- name: transferencia
  query_file: transferencia.sql
  schema_file: transferencia.json
  delta_config:
    column: TRF_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: TRF_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - TRF_ID
  partitioning_config:
    type: DAY
    column: TRF_DT_ATUALIZACAO
  clustering_config:
    columns:
      - TRF_ID
      - TRF_OLD_ID
  
- name: turma
  query_file: turma.sql
  schema_file: turma.json
  delta_config:
    column: TUR_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: TUR_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - TUR_ID
  partitioning_config:
    type: DAY
    column: TUR_DT_ATUALIZACAO
  clustering_config:
    columns:
      - TUR_ID
      - TUR_OLD_ID
  
- name: turma_aluno
  query_file: turma_aluno.sql
  schema_file: turma_aluno.json
  delta_config:
    column: updatedAt
    format: '%Y-%m-%d %H:%M:%S.%f %Z'
    type: timestamp
  read_partitioning_config:
    column: id
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - id
  partitioning_config:
    type: DAY
    column: updatedAt
  clustering_config:
    columns:
      - id
  
- name: turma_professor
  query_file: turma_professor.sql
  schema_file: turma_professor.json
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - PRO_ID
      - TUR_ID
  partitioning_config:
    type: DAY
  clustering_config:
    columns:
      - PRO_ID
      - TUR_ID
  
- name: usuario
  query_file: usuario.sql
  schema_file: usuario.json
  delta_config:
    column: USU_DT_ATUALIZACAO
    format: '%Y-%m-%d %H:%M:%S %Z'
    type: timestamp
  read_partitioning_config:
    column: USU_ID
    num_partitions: 1
  merge_config:
    strategy: 'upsert' #'upsert' or 'scd2'
    keys:
      - USU_ID
  partitioning_config:
    type: DAY
    column: USU_DT_ATUALIZACAO
  clustering_config:
    columns:
      - USU_ID
      - USU_EMAIL
  


# Copyright 2025 TecOnca Data Solutions.


# Chunks de tabelas para ingestão
chunks:
- name: ALL
  lista:
  - aluno_teste_resposta
  - aluno_teste_resposta_historico
  - aluno_teste
  - report_question
  - report_descriptor
  - report_race
  - turma_aluno
  - aluno
  - report_subject
  - report_not_evaluated
  - infrequencia
  - report_edition
  - transferencia
  - turma
  - avaliacao_municipio
  - forget_password
  - aluno_alu_deficiencias_pcd
  - usuario
  - messages_schools_escola
  - teste_gabarito
  - turma_professor
  - job
  - escola
  - professor
  - matriz_referencia_topico_items
  - teste
  - messages_municipios_municipio
  - avaliacao_teste
  - matriz_referencia_topico
  - sub_perfil_area
  - regionais
  - municipio
  - matriz_referencia_serie
  - avaliacao
  - messages
  - matriz_referencia
  - avaliacao_online_question_alternative
  - series
  - migrations
  - area
  - pcd
  - ano_letivo
  - estados
  - avaliacao_online_page
  - avaliacao_online_question
  - sub_perfil
  - formacao
  - disciplina
  - raca
  - genero
  - perfil_base
  - avaliacao_online
  
- name: HEAVIEST_1
  lista:
  - aluno_teste_resposta
  
- name: HEAVIEST_2
  lista:
  - aluno_teste_resposta_historico
  
- name: HEAVIEST_3
  lista:
  - aluno_teste
  - report_descriptor
  - report_race
  
- name: REPLACE_ALWAYS_UNIQUE
  lista:
  - report_question
  
- name: MEDIUM
  lista:
  - turma_aluno
  - aluno
  - report_subject
  - report_not_evaluated
  - infrequencia
  - report_edition
  - transferencia
  - turma
  
- name: LIGHT
  lista:
  - avaliacao_municipio
  - forget_password
  - usuario
  - teste_gabarito
  - job
  - escola
  - professor
  - matriz_referencia_topico_items
  - teste
  - matriz_referencia_topico
  - regionais
  - municipio
  - avaliacao
  - messages
  - matriz_referencia
  - avaliacao_online_question_alternative
  - series
  - area
  - pcd
  - ano_letivo
  - estados
  - avaliacao_online_page
  - avaliacao_online_question
  - sub_perfil
  - formacao
  - disciplina
  - raca
  - genero
  - perfil_base
  - avaliacao_online
  
- name: REPLACE_ALWAYS
  lista:
  - aluno_alu_deficiencias_pcd
  - messages_schools_escola
  - turma_professor
  - messages_municipios_municipio
  - avaliacao_teste
  - sub_perfil_area
  - matriz_referencia_serie
  - migrations
  
